/* jquery.minimuslider v.1.3 | (c) 2015 Federica Sibella musings(at)musings(dot)it | http://www.musings.it | MIT license */
!function(i){function t(t){var n=i("#minimus-slide"+t.instance+"_"+t.current),e=n.find("img");if(e.length>0){t.is_retina&&""!==e.attr("data-src-2x")&&void 0!=e.attr("data-src-2x")?e.attr("src")!==e.attr("data-src-2x")&&e.attr("src",e.attr("data-src-2x")):e.attr("src")!==e.attr("data-src")&&e.attr("src",e.attr("data-src"));var a=e,o=new Image;o.onload=function(){var i=o.width,a=o.height,r=a/i,s=t.slider,d=t.calc_width,c=t.calc_height,m=Math.round(d*r);if("adjust"===t.options.ratio)n.css({height:m}),e.css({width:d,height:m}),s.css({height:m});else if(m>c){var u=Math.round((m-c)/2);e.css({width:d,height:m,top:-u})}else{var h=Math.round(c/r),l=Math.round((h-d)/2);e.css({width:h,height:c,left:-l})}},o.src=a.attr("src"),0===n.find(".minimus-caption").length&&void 0!==e.attr("title")&&""!==e.attr("title")&&n.append("<div class='minimus-caption'><p>"+e.attr("title")+"</p></div>").promise().done(function(){var i=n.find(".minimus-caption").outerHeight(!0);n.find(".minimus-caption").css({bottom:-i}).delay(800).animate({bottom:0},300)})}}function n(t){var n=i("#minimus-slide"+t.instance+"_"+t.current);if(n.find(".minimus-caption").length>0){var e=n.find(".minimus-caption").outerHeight(!0);n.find(".minimus-caption").css({bottom:-e}).delay(800).animate({bottom:0},300)}}function e(t,n,e){var o=i("#minimus-slide"+t.instance+"_"+t.current),r=i("#minimus-slide"+t.instance+"_"+n),s=t.options,d=t.calc_width,c=t.calc_height,m=0,u=0,h=t.prev,l=t.next;switch(h.off(),l.off(),i(document).on("touchend").off(),i(document).on("keydown").off(),"n"===e?(m=d+t.margin,u=c+t.margin):"p"===e&&(m=-(d+t.margin),u=-(c+t.margin)),s.animation_type){case"horizontal":o.css({left:m}).show(),r.animate({left:-m},s.animation_duration,function(){r.hide().toggleClass("active")}),o.animate({left:0},s.animation_duration,function(){a(t)});break;case"vertical":o.css({top:u}).show(),r.animate({top:-u},s.animation_duration,function(){r.hide().toggleClass("active")}),o.animate({top:0},s.animation_duration,function(){a(t)});break;case"fade":r.fadeOut(s.animation_duration).toggleClass("active"),o.fadeIn(s.animation_duration,function(){a(t)})}}function a(t){var n=i("#minimus-slide"+t.instance+"_"+t.current),e=t.prev,a=t.next,o=t.slider,r=t.mm;n.toggleClass("active"),a.on("click touchstart touchend",function(t){t.preventDefault(),i(this).minimus("next")}),e.on("click touchstart touchend",function(t){t.preventDefault(),i(this).minimus("prev")}),i(document).on("touchstart",o,function(i){var t=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];void 0===i.originalEvent.touches&&(t=i),r.ox=t.pageX,r.oy=t.pageY,r.startTime=(new Date).getTime()}),i(document).on("touchend",o,function(i){var t=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];void 0===i.originalEvent.touches&&(t=i),r.dx=t.pageX-r.ox,r.dy=t.pageY-r.oy,r.endTime=(new Date).getTime()-r.startTime,(r.dx<-r.swipeTreshold||r.dy<-r.swipeTreshold)&&r.endTime<r.allowedTime?o.minimus("next"):(r.dx>r.swipeTreshold||r.dy>r.swipeTreshold)&&r.endTime<r.allowedTime&&o.minimus("prev")}),i(document).on("keydown",function(i){37==(i.keyCode||i.which)&&o.minimus("prev"),39==(i.keyCode||i.which)&&o.minimus("next")})}function o(t,n){var e,a=i("#minimus-slide"+t+"_"+n);a.children().is("audio,video")&&(e=a.children("audio,video"),e[0].paused===!1&&e[0].pause())}function r(i){if("string"==typeof i){var t=i.indexOf("_");-1!=t&&(i=i.substr(t+1))}return i}function s(i,t){var n=t,e=0,a=0;if("string"==typeof i){var o=i.indexOf("%");-1!=o&&(e=parseInt(i.slice(0,-1))/100,a=Math.round(n*e))}else a=i;return a}function d(t){var n=t.slider,e=t.slide,a=t.min_width,o=t.min_height,r=t.slider_ratio,d=t.calc_width,c=t.calc_height;d=s(t.options.width,Math.min(n.parent().width(),i(window).width()));var m=i("#minimus-slide"+t.instance+"_"+t.current),u=m.find("img");if(u.length>0){var h=u,l=new Image;l.onload=function(){var i=l.width,n=l.height,e=n/i,a=t.slider,o=t.calc_width,r=t.calc_height,s=Math.round(o*e);if("adjust"===t.options.ratio)m.css({height:s}),u.css({width:o,height:s}),a.css({height:s});else if(s>r){var d=Math.round((s-r)/2);u.css({width:o,height:s,top:-d})}else{var c=Math.round(r/e),h=Math.round((c-o)/2);u.css({width:c,height:r,left:-h})}},l.src=h.attr("src")}return c=Math.round(d*r),a>d&&(d=a,c=Math.round(d*r),o>c&&(c=o)),o>c&&(c=o,d=Math.round(c/r),a>d&&(d=a)),e.css({width:d,height:c}),e.children("video,iframe").css({width:d,height:c}),n.css({width:d,height:c}),t.calc_width=d,t.calc_height=c,t.slide=e,t.slider=n,t}var c=[],m=0,u={init:function(n){this.each(function(){var e={width:"100%",height:"100%",ratio:.5625,animation_type:"horizontal",animation_duration:600,animation_start:"manual",animation_interval:4e3},a=i(this),o=a.data("minimus"),r=i(),d=i(),u=i(),h=i(),l=i(),f=i(),v=i(),p=0,g=0,w=0,_=100,x=.565,y=0,T=0,b=320,k=180,M={},E=window.devicePixelRatio>1.3||window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches;if(M.swipeTreshold=100,M.allowedTime=300,r=i.extend(e,n),a.attr("data-id","minimus-slider_"+m),d=a.find(".minimus-slide"),g=d.length-1,d.each(function(t){i(this).attr("id","minimus-slide"+m+"_"+t)}),u=a.next(".minimus-navslide"),h=u.find(".minimus-start").attr("data-id","minimus-start_"+m),l=u.find(".minimus-stop").attr("data-id","minimus-stop_"+m),f=u.find(".minimus-next").attr("data-id","minimus-next_"+m),v=u.find(".minimus-prev").attr("data-id","minimus-prev_"+m),y=s(r.width,a.parent().width()),"number"==typeof r.ratio&&(x=r.ratio),T=Math.round(y*x),d.css({"box-sizing":"content-box",width:y,height:T,top:0,left:0}),void 0!==typeof d.children("img").attr("data-src")&&d.children("img").attr("src")!==d.children("img").attr("data-src")){var D=d.children("img").attr("src");d.children("img").css({background:"url("+D+") no-repeat center center"})}return d.children("img,video,iframe").css({"box-sizing":"content-box",position:"absolute",top:0,left:0,width:y,height:T}),d.not(":first").hide(),d.filter(":first").addClass("active"),a.css({"box-sizing":"content-box",width:y,height:T}),f.on("click touchstart touchend",function(t){t.preventDefault(),i(this).minimus("next")}),v.on("click touchstart touchend",function(t){t.preventDefault(),i(this).minimus("prev")}),l.on("click",function(t){t.preventDefault(),a.minimus("stop"),i(this).hide(),h.show()}),h.on("click",function(t){t.preventDefault(),a.minimus("start"),i(this).hide(),l.show()}),i(document).on("touchstart",a,function(i){var t=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];void 0===i.originalEvent.touches&&(t=i),M.ox=t.pageX,M.oy=t.pageY,M.startTime=(new Date).getTime()}),i(document).on("touchend",a,function(i){var t=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0];void 0===i.originalEvent.touches&&(t=i),M.dx=t.pageX-M.ox,M.dy=t.pageY-M.oy,M.endTime=(new Date).getTime()-M.startTime,(M.dx<-M.swipeTreshold||M.dy<-M.swipeTreshold)&&M.endTime<M.allowedTime?a.minimus("next"):(M.dx>M.swipeTreshold||M.dy>M.swipeTreshold)&&M.endTime<M.allowedTime&&a.minimus("prev")}),i(document).on("keydown",function(i){37==(i.keyCode||i.which)&&a.minimus("prev"),39==(i.keyCode||i.which)&&a.minimus("next")}),a.data("minimus",{slider:a,slide:d,totslides:g,margin:_,navslide:u,start:h,stop:l,prev:v,next:f,current:p,timer:w,options:r,instance:m,slider_ratio:x,calc_width:y,calc_height:T,min_width:b,min_height:k,mm:M,is_retina:E}),o=a.data("minimus"),c[m]=o,t(a.data("minimus")),a.minimus("resize"),"auto"==r.animation_start?(l.show(),h.hide(),a.minimus("start")):"manual"==r.animation_start&&(a.minimus("stop"),l.hide(),h.hide()),m++,c})},next:function(){var a=r(i(this).attr("data-id")),s=c[a],d=s.current;return s.current++,s.current>s.totslides&&(s.current=0),o(a,d),t(s),e(s,d,"n"),n(s),c[a]=s,c},prev:function(){var a=r(i(this).attr("data-id")),s=c[a],d=s.current;return s.current--,s.current<0&&(s.current=s.totslides),o(a,d),t(s),e(s,d,"p"),n(s),c[a]=s,c},resize:function(t){"number"!=typeof t&&(t=r(i(this).attr("data-id")));var n=c[t];return void 0!==n&&(n=d(n),c[t]=n),c},start:function(){var t=r(i(this).attr("data-id")),n=c[t],e=n.slider;return 0!==n.timer&&clearInterval(n.timer),n.timer=setInterval(function(){e.minimus("next")},n.options.animation_interval),c[t]=n,c},stop:function(){var t=r(i(this).attr("data-id")),n=c[t];return clearInterval(n.timer),c[t]=n,c},update:function(t){i(this).minimus("destroy"),i(this).minimus("init",t)},destroy:function(){var t=r(i(this).attr("data-id")),n=c[t];n.prev.off(),n.next.off(),i(document).on("touchend").off(),i(document).on("keydown").off(),n.slider.minimus("stop"),n.slide.find("minimus-caption").remove(),i.removeData(n,"minimus"),this.unbind(),this.element=null}};i(window).resize(function(){setTimeout(function(){for(var t=0;m>t;t++)i.fn.minimus("resize",t)},100)}),i.fn.minimus=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void i.error("Method "+t+" does not exist on jQuery.minimus"):u.init.apply(this,arguments)}}(jQuery);